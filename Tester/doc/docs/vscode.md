Visual Studio Code (далее vscode) является продвинутым текстовым редактором, возможности которого значительно превосходят возможности встроенного в Тестер редактора модулей. При разработке большого числа сложных тестов, улучшенная эргономика работы с кодом может стать важной составляющей всего процесса написания, анализа и запуска сценариев.

Механизм интеграции Тестера с vscode основан на способности Тестера выгружать сценарии в файлы их обратной загрузки в базу тестов. Специальный плагин и внешняя компонента позволяют общаться Тестеру с vscode для маршрутизации команд между двумя приложениями. Операции выгрузки и загрузки происходят как в ручном так и автоматическом режиме.

Для работы в интегрированном режиме, оба приложения (Тестер и vscode) должны быть запущены.

Подготовка Тестера
------------------

!!! warning "Внимание"
	Данный раздел справки для версии 1.3.5 не актуален и находится в процессе доработки 

Для того, чтобы начать взаимодействовать с vscode, необходимо смонтировать приложение(я) Тестера в папки на диске:

![](/img/2018_02_28_02_01_154.png)

Затем, необходимо создать запись для монтируемых приложений, например так:

![](/img/2018_03_12_02_18_291.png)

Внимание! Флаг Маппинг должен быть включен, иначе Тестер не сможет общаться с vscode в автоматическом режиме.

Если вы монтируете более одного приложения, рекомендуется указывать для них общий начальный путь к папке на диске. Например, на картинке выше, приложение ERP2 и <Общее> имеют общий начальный путь c:\\tests\\. Такая структура (общий начальный путь) позволяет плагину vscode редактировать и осуществлять переходы к связанным сценариям сразу для всех смонтированных приложений с общей начальной папкой. В противном случае, переходы к связанным сценариям, например, при нажатии F12 на параметре метода `Вызвать ( “Общее.Найти” )`, будут затруднены.

Итак, после задания монтируемых приложений, нужно выгрузить все сценарии согласно указанных директорий:

![](/img/2018_02_28_02_04_047.png)

Откроется обработка выгрузки сценариев, где необходимо проделать следующее:

![](/img/2018_02_28_02_57_0317.png)

Внимание! Если у вас в списке (что на картинке выше) отсутствуют приложения, которые вы монтировали в репозиториях, тогда возможно, по каким-то причинам Тестеру не удалось создать узлы обмена сценариями. В этом случае, необходимо через меню Все функции, открыть план обмена Изменения, и создать в нем необходимый узел, пример на картинке ниже:

![](/img/2018_03_18_02_55_381.png)

На этом этапе, подготовительная работа в Тестере завершена.

Подготовка Visual Studio Code
-----------------------------

Необходимо скачать и установить vscode. Страница для скачивания: [https://code.visualstudio.com/](https://code.visualstudio.com/)

Внимание! если вы скачали 32-битную версию или установили vscode в директорию, отличную от C:\\Program Files\\Microsoft VS Code, тогда укажите в Тестере, в форме настройки компьютера, путь к запускаемому файлу vscode, как показано на рисунках ниже

![](/img/2018_03_12_02_20_102.png)

![](/img/2018_03_12_02_21_163.png)

Работа в vscode
---------------

На данном этапе все настройки завершены, теперь можно редактировать и запускать сценарии из vscode.

На примере демо-базы это будет выглядеть так:

![](/img/2018_03_12_02_28_324.png)

После этого, запустится vscode и предложит вам установить плагин, как показано на картинке ниже:

![](/img/2018_03_12_02_29_565.png)

Нажмите на указанную кнопку и установите предлагаемый плагин:

![](/img/2018_03_12_02_30_506.png)

После того, как расширение Tester 1C будет установлено (вместе с ним, будет установлено расширение xDrivenDevelopment.language-1c-bsl от специалистов команды xDrivenDevelopment, за что им отдельная благодарность), необходимо перезагрузить редактор:

![](/img/2018_03_12_02_32_117.png)

На этом настройка завершена, можно начинать работу.

На момент написания статьи, плагин vscode поддерживает следующие операции:

1.  Интеллисенс всех функций тестера на двух языках (справка пока только на русском). Навигация к сценариям, заданным в методах `Вызвать ()` и `Позвать ()`.
2.  Считывание полей тестируемого приложения в процесса набора параметра функции с фильтрацией по типу. Примечание: тестируемое приложение при этом должно быть запущено
3.  Запуск теста, кнопка `F5`
4.  Запуск выделенного фрагмента кода, комбинация `ctrl+alt+R`
5.  Синтаксический контроль, комбинация `ctrl+F7`
6.  Вывод диагностических сообщений в панель Output (см. метод `ВСтудию()/VStudio()`)
7.  Вывод сообщений об ошибках в панель Problems
8.  Назначение основного сценария (кнопка `F1` / `Set Main`)
9.  Сниппеты. При наборе тест плагин выдаст все допустимые методы Тестера

Другие полезные комбинации клавиш:

`ctrl + E`. Открывает окно нечеткого поиска сценария для его открытия в новой вкладке.

`ctrl + shift + E`. Активация дерева файлов проекта.

`alt + F12`. Открытие в сплывающем окне модуля процедуры, функции или сценария. Удобно использовать для беглого просмотра когда связанного сценария.

`ctrl + shift + O`. Быстрый переход к процедуре/функции кода сценария.

`ctrl + shift + F`, `ctrl + shift + H`. Глобальный поиск и глобальная замена. Важной способностью этих функций является возможность указания начальной папки (поле чувствительно к регистру) поиска/замены. 

!!! tip ""
	Рекомендуется создавать тесты, переименовывать, удалять и переносить между папками в самой среде Тестера.

Полезные приемы работы
----------------------

Среда vscode обладает обширным функционалом по работе с файлами и текстами модулей. Например: поиск и замена во всех файлах по регулярным выражениям, сравнение файлов, настройка команд и комбинаций клавиш, настройка шаблонов, закладок и многое другое. Стоит инвестировать некоторое время на изучение и настройку среды с целью получения выигрыша во времени от использования продвинутого редактора модулей.